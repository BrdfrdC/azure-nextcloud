(()=>{var e=window.location.href,t=window.location.hash;document.addEventListener("DOMContentLoaded",(()=>{t?(t=t.replace("#access_token=","").split("&")[0],sessionStorage.setItem("MyToken",t),o()):function(){var t="https://login.microsoftonline.com/common/oauth2/authorize",o=document.createElement("form");o.setAttribute("method","GET"),o.setAttribute("action",t);var n={client_id:"457a5491-f470-4c0c-beae-efa300de112b",redirect_uri:e,response_type:"token",resource:"https://management.core.windows.net"};for(var s in n){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",s),a.setAttribute("value",n[s]),o.appendChild(a)}document.body.appendChild(o),o.submit()}()}));let o=e=>{let t=sessionStorage.getItem("MyToken"),o=new Headers;o.append("Authorization","Bearer ".concat(t));let n=new Request("https://management.azure.com/subscriptions?api-version=2022-12-01",{method:"GET",mode:"cors",headers:o});async function s(){const e=await function(){let e;return console.log(n),fetch(n).then((e=>e.json())).then((t=>{console.log(t),e=t.value[0].id})).catch((e=>{console.error(e.message)})),new Promise((t=>{setTimeout((()=>{t(e)}),2e3)}))}();let t;sessionStorage.setItem("subID",e);let s="https://management.azure.com".concat(e,"/providers/Microsoft.Compute/virtualMachines?api-version=2023-07-01"),a=new Request(s,{method:"GET",mode:"cors",headers:o});return console.log(a),fetch(a).then((e=>e.json())).then((e=>{console.log(e),t=e})).catch((e=>{console.log("Error message:"),console.error(e.message)})),new Promise((e=>{setTimeout((()=>{e(t)}),2e3)}))}!async function(){const e=await s();for(let t=0;t<e.value.length;t++){console.log(e.value[t].name);const o=document.createElement("div"),n=document.createTextNode(e.value[t].name);o.appendChild(n),document.body.insertBefore(o,document.getElementById("vm-footer"))}}()}})();
//# sourceMappingURL=azure-azureScript.js.map