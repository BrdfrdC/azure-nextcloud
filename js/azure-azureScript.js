(()=>{"use strict";function e(e){this.message=e}e.prototype=new Error,e.prototype.name="InvalidCharacterError";var t="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var n=String(t).replace(/=+$/,"");if(n.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,r,a=0,s=0,i="";r=n.charAt(s++);~r&&(o=a%4?64*o+r:r,a++%4)?i+=String.fromCharCode(255&o>>(-2*a&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return i};function n(e){var n=e.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(t(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(n)}catch(e){return t(n)}}function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError";const r=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}};var a=window.location.href,s=window.location.hash;document.addEventListener("DOMContentLoaded",(()=>{!s&&!sessionStorage.getItem("MyToken")||sessionStorage.getItem("MyToken")&&r(sessionStorage.getItem("MyToken")).exp<Date.now()/1e3?(sessionStorage.clear(),function(){var e="https://login.microsoftonline.com/common/oauth2/authorize",t=document.createElement("form");t.setAttribute("method","GET"),t.setAttribute("action",e);var n={client_id:"457a5491-f470-4c0c-beae-efa300de112b",redirect_uri:a,response_type:"token",resource:"https://management.core.windows.net"};for(var o in n){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",o),r.setAttribute("value",n[o]),t.appendChild(r)}document.body.appendChild(t),t.submit()}()):"#VM"==s?u():(sessionStorage.getItem("MyToken")||(s=s.replace("#access_token=","").split("&")[0],sessionStorage.setItem("MyToken",s)),i())}));let i=e=>{if(sessionStorage.getItem("subID"))return;let t=sessionStorage.getItem("MyToken"),n=new Headers;n.append("Authorization","Bearer ".concat(t));let o=new Request("https://management.azure.com/subscriptions?api-version=2022-12-01",{method:"GET",mode:"cors",headers:n});!function(){let e;fetch(o).then((e=>e.json())).then((t=>{console.log(t),e=t.value[0].id,sessionStorage.setItem("subID",e)})).catch((e=>{console.error(e.message)})),new Promise((t=>{setTimeout((()=>{t(e)}),2e3)}))}()};var c,d;function l(){if(sessionStorage.getItem("subID")){var e=document.getElementById("app-navigation-vue");(c=document.createElement("a")).setAttribute("class","app-navigation-entry-link"),(d=document.createElement("div")).setAttribute("class","app-navigation-entry");const t=document.createTextNode("Virtual Machines");c.appendChild(t),d.appendChild(c),e.appendChild(d),c.addEventListener("click",(()=>{window.location.hash="#VM",location.reload()}))}}sessionStorage.getItem("subID")?l():setTimeout(l,2e3);let u=e=>{const t=sessionStorage.getItem("subID");let n,o="https://management.azure.com".concat(t,"/providers/Microsoft.Compute/virtualMachines?api-version=2023-07-01"),r=sessionStorage.getItem("MyToken"),a=new Headers;a.append("Authorization","Bearer ".concat(r));let s=new Request(o,{method:"GET",mode:"cors",headers:a});async function i(){return fetch(s).then((e=>e.json())).then((e=>{console.log(e),n=e})).catch((e=>{console.log("Error message:"),console.error(e.message)})),new Promise((e=>{setTimeout((()=>{e(n)}),2e3)}))}!async function(){const e=await i();for(let t=0;t<e.value.length;t++){const n=document.createElement("tr");n.setAttribute("class","content-entry");const o=document.createTextNode(e.value[t].name);n.appendChild(o);document.getElementById("content-list").appendChild(n)}}()}})();
//# sourceMappingURL=azure-azureScript.js.map