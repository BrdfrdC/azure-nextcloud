{"version":3,"file":"azure-azureScript.js","mappings":"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","sources":["webpack:///azure/node_modules/jwt-decode/build/jwt-decode.esm.js","webpack:///azure/src/azureScript.js"],"sourcesContent":["function e(e){this.message=e}e.prototype=new Error,e.prototype.name=\"InvalidCharacterError\";var r=\"undefined\"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,\"\");if(t.length%4==1)throw new e(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var n,o,a=0,i=0,c=\"\";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(o);return c};function t(e){var t=e.replace(/-/g,\"+\").replace(/_/g,\"/\");switch(t.length%4){case 0:break;case 2:t+=\"==\";break;case 3:t+=\"=\";break;default:throw\"Illegal base64url string!\"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t=\"0\"+t),\"%\"+t})))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if(\"string\"!=typeof e)throw new n(\"Invalid token specified\");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(\".\")[o]))}catch(e){throw new n(\"Invalid token specified: \"+e.message)}}n.prototype=new Error,n.prototype.name=\"InvalidTokenError\";export default o;export{n as InvalidTokenError};\n//# sourceMappingURL=jwt-decode.esm.js.map\n","import jwt_decode from \"jwt-decode\";\r\n\r\nvar homeURL = window.location.href;\r\nvar URLhash = window.location.hash\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    if((!URLhash && !sessionStorage.getItem('MyToken')) || (sessionStorage.getItem('MyToken') && (jwt_decode(sessionStorage.getItem('MyToken')).exp < Date.now() / 1000))) {\r\n        sessionStorage.clear();\r\n        oauth2Signin();\r\n    } else if (URLhash == '#VM') {\r\n        sendVMRequest();\r\n    } else if (!sessionStorage.getItem('MyToken')) {\r\n        URLhash = URLhash.replace('#access_token=','').split('&')[0];\r\n        sessionStorage.setItem('MyToken', URLhash);\r\n        sendSubRequest();\r\n    } else {\r\n        sendSubRequest();\r\n    }\r\n})\r\n\r\nfunction oauth2Signin() {\r\n    var endpoint = 'https://login.microsoftonline.com/common/oauth2/authorize';\r\n\r\n    var form = document.createElement('form');\r\n    form.setAttribute('method', 'GET');\r\n    form.setAttribute('action', endpoint);\r\n\r\n    var params = {\r\n        'client_id': '457a5491-f470-4c0c-beae-efa300de112b',\r\n        'redirect_uri': homeURL,\r\n        'response_type': 'token',\r\n        'resource': 'https://management.core.windows.net',\r\n    }\r\n\r\n    for (var p in params) {\r\n        var input = document.createElement('input');\r\n        input.setAttribute('type', 'hidden');\r\n        input.setAttribute('name', p);\r\n        input.setAttribute('value', params[p]);\r\n        form.appendChild(input);\r\n    }\r\n    \r\n    document.body.appendChild(form);\r\n    form.submit();\r\n}\r\n\r\nlet sendSubRequest = (ev) => {\r\n\r\n    if(sessionStorage.getItem('subID')) {\r\n        return;\r\n    }\r\n\r\n    let subscriptionURL = 'https://management.azure.com/subscriptions?api-version=2022-12-01';\r\n    let token = sessionStorage.getItem('MyToken');\r\n    let header = new Headers();\r\n    //header.append('Authentication', `Bearer ${token}`);\r\n    header.append('Authorization', `Bearer ${token}`);\r\n\r\n    let request = new Request(subscriptionURL, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: header\r\n    });\r\n\r\n    function fetchSubscriptionID() {\r\n        let subID;\r\n        fetch(request)\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                console.log(data);\r\n                subID = data.value[0].id;\r\n                sessionStorage.setItem('subID', subID);\r\n            })\r\n            .catch(error => {\r\n                console.error(error.message);\r\n            });\r\n        return new Promise((resolve) => {\r\n            setTimeout(() => {\r\n                resolve(subID);\r\n                }, 2000);\r\n        })\r\n    }    \r\n    fetchSubscriptionID();\r\n}\r\n\r\nvar VMButton;\r\nvar VMDiv\r\n\r\nif(!sessionStorage.getItem('subID')) {\r\n    setTimeout(createVMButton, 2000);\r\n} else {\r\n    createVMButton();\r\n}\r\n\r\n\r\nfunction createVMButton() {\r\n    if(sessionStorage.getItem('subID')) {\r\n        var navElement = document.getElementById('app-navigation-vue');\r\n    \r\n        VMButton = document.createElement('a');\r\n        VMButton.setAttribute('class', 'app-navigation-entry-link');\r\n        VMDiv = document.createElement('div');\r\n        VMDiv.setAttribute('class', 'app-navigation-entry');\r\n    \r\n        const entryText = document.createTextNode('Virtual Machines');\r\n        VMButton.appendChild(entryText);\r\n        VMDiv.appendChild(VMButton);\r\n        navElement.appendChild(VMDiv);\r\n        \r\n        VMButton.addEventListener('click', () => {\r\n            window.location.hash = '#VM';\r\n            location.reload();\r\n        });\r\n    }\r\n}\r\n\r\nlet sendVMRequest = (ev) => {\r\n    const subscriptionID = sessionStorage.getItem('subID');\r\n    let VMInfo;\r\n\r\n    let vmURL = 'https://management.azure.com'.concat(subscriptionID, '/providers/Microsoft.Compute/virtualMachines?api-version=2023-07-01');\r\n    let token = sessionStorage.getItem('MyToken');\r\n    let header = new Headers();\r\n    header.append('Authorization', `Bearer ${token}`);\r\n\r\n    let vmRequest = new Request(vmURL, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: header\r\n    });\r\n\r\n    async function fetchVM() {\r\n        fetch(vmRequest)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            console.log(data);\r\n            VMInfo = data;\r\n        })\r\n        .catch(error => {\r\n            console.log(\"Error message:\")\r\n            console.error(error.message);\r\n        });\r\n\r\n        return new Promise((resolve) => {\r\n            setTimeout(() => {\r\n                resolve(VMInfo);\r\n                }, 2000);\r\n        })\r\n    }\r\n\r\n    async function addVMToHTML() {\r\n        const VMInfo = await fetchVM();\r\n\r\n        for(let i = 0; i < VMInfo.value.length; i++) {\r\n            const newEntry = document.createElement('tr');\r\n            newEntry.setAttribute('class', 'content-entry');\r\n            const entryText = document.createTextNode(VMInfo.value[i].name);\r\n            newEntry.appendChild(entryText);\r\n\r\n            const tableElement = document.getElementById('content-list');\r\n            tableElement.appendChild(newEntry);\r\n        }\r\n    }\r\n    \r\n    addVMToHTML();\r\n}"],"names":["e","this","message","prototype","Error","name","r","window","atob","bind","t","String","replace","length","n","o","a","i","c","charAt","fromCharCode","indexOf","decodeURIComponent","charCodeAt","toString","toUpperCase","header","JSON","parse","split","homeURL","location","href","URLhash","hash","document","addEventListener","sessionStorage","getItem","jwt_decode","exp","Date","now","clear","endpoint","form","createElement","setAttribute","params","p","input","appendChild","body","submit","oauth2Signin","sendVMRequest","setItem","sendSubRequest","ev","token","Headers","append","concat","request","Request","method","mode","headers","subID","fetch","then","response","json","data","console","log","value","id","catch","error","Promise","resolve","setTimeout","fetchSubscriptionID","VMButton","VMDiv","createVMButton","navElement","getElementById","entryText","createTextNode","reload","subscriptionID","VMInfo","vmURL","vmRequest","async","fetchVM","newEntry","addVMToHTML"],"sourceRoot":""}